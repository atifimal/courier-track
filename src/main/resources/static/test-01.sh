#!/bin/bash

map=(
"40.99189136305207 29.119517459094368"
"40.991938568713124 29.1199865124"
"40.99197003913504 29.12044514229885"
"40.992013310940685 29.12093504241806"
"40.99204871512416 29.1213988840203"
"40.99209198687815 29.121862725622538"
"40.99213132481168 29.12232656722478"
"40.9921667289318 29.122795620530415"
"40.99219033166796 29.123264673836047"
"40.99221000060831 29.123733727141676"
"40.99219819924479 29.12419756874392"
"40.99220606682072 29.12465619864276"
"40.99218639787918 29.125151310465377"
"40.992150993769656 29.125635998881197"
"40.9918834954386 29.125865313830623"
"40.99153731951673 29.1257662914661"
"40.991195075625406 29.12564642228799"
"40.99083709448178 29.12551612970309"
"40.99049091306575 29.12541189563517"
"40.99015653156312 29.12552134140649"
"40.989896892991524 29.125912219161183"
"40.98955375911738 29.12572459792831"
"40.989250844581875 29.125292026546447"
"40.98883384307476 29.125239909512484"
"40.988456179056655 29.125031441376645"
"40.98823980807167 29.124979324342686"
"40.98788967897371 29.124765644503455"
"40.987590690856635 29.12435913163857"
"40.9873153058652 29.123952618773686"
"40.987083194734204 29.12359301109803"
"40.986827478169445 29.123139592902582"
"40.98657962886027 29.12266532789355"
"40.98624129337893 29.122269238435457"
"40.986205886077066 29.121596928697382"
"40.986170478756165 29.120950677476287"
"40.98611933481467 29.12039823691632"
"40.986091795752806 29.11987185487333"
"40.98599344186658 29.11942886008467"
"40.98580066780313 29.118808667159044"
"40.98565510335677 29.11817805104813"
"40.98572198435852 29.117724632852685"
"40.98611540064277 29.117495317903266"
"40.986146873844135 29.11685949008896"
"40.98609966403647 29.11611942820674"
)

PARALLEL_REQUESTS=5
URL="http://localhost:8089/courier-track"

map_length=${#map[@]}

for ((i=0; i<$map_length; i++))
do
    latlng=${map[i]}

    lat=$(echo $latlng | cut -d' ' -f1)
    lng=$(echo $latlng | cut -d' ' -f2)

    curl -X POST -H "Content-Type: application/json" -d "{\"courierId\": 1, \"lat\":\"$lat\", \"lng\":\"$lng\"}" $URL &

    if (( $i % $PARALLEL_REQUESTS == 0 )); then
            wait
    fi
done

wait

echo "OK"